{"project":"apps/core/preloaded/menu-screen","branch":"tizen","id":"I814e070876572164e3a8ffd746a33b30cbafdfed","number":"13632","subject":"init wayland support.","owner":{"name":"wang fei","email":"feix.w.wang@intel.com","username":"wangfei"},"url":"https://review.tizen.org/gerrit/13632","commitMessage":"init wayland support.\n\nThe display server based on X or Wayland, is now a choice of different profile in Tizen 3.0.\nBasically and consistently, two macros were used \"with wayland\" and \"with x\".\nBelow summarize the combination of the macros:\n\n| wayland |  x  | meaning\n|---------------------------\n|   0     |  1  | pure X11 platform(no wayland)\n|   1     |  0  | pure wayland platform (no X11)\n|   1     |  1  | wayland but X compatibility\n|   0     |  0  | no X and no wayland\n\nThis method unifies the meaning and usage. Deploy this method to menu-screen package.\nCurrently we need \"pure wayland platform (no X11)\" status,so \"with wayland\" and \"with x\" are\ndefined into \"1\" and \"0\" in build.conf file.If you need other status of above illustration,\nplease change values of \"with x\" and \"with wayland\" in your build.conf file.\n\nSigned-off-by: wangfei \u003cfeix.w.wang@intel.com\u003e\nChange-Id: I814e070876572164e3a8ffd746a33b30cbafdfed\n","createdOn":1386743333,"lastUpdated":1389356465,"sortKey":"002a5a4500003540","open":true,"status":"NEW","comments":[{"timestamp":1386743437,"reviewer":{"name":"Robot Tizen","username":"tizenrobot"},"message":"Patch Set 1:\n\n[BUILD CHECK RESULT] This change is built against OBS project Tizen:IVI: \n\n repository     arch           result         \n\n standard       i586           succeeded"},{"timestamp":1386743485,"reviewer":{"name":"Robot Tizen","username":"tizenrobot"},"message":"Patch Set 1:\n\n[BUILD CHECK RESULT] This change is built against OBS project devel:ivi: \n\n repository     arch           result         \n\n standard       i586           succeeded"},{"timestamp":1386743529,"reviewer":{"name":"Robot Tizen","username":"tizenrobot"},"message":"Patch Set 1:\n\n[BUILD CHECK RESULT] This change is built against OBS project Tizen:Mobile: \n\n repository     arch           result         \n\n arm            x86_64         disabled       \n\n arm            armv7l         succeeded      \n\n arm            i586           disabled"},{"timestamp":1386750862,"reviewer":{"name":"Juan Zhao","username":"juanzhao"},"message":"Patch Set 1:\n\n(2 comments)"},{"timestamp":1386851130,"reviewer":{"name":"wang fei","email":"feix.w.wang@intel.com","username":"wangfei"},"message":"Uploaded patch set 2."},{"timestamp":1386851228,"reviewer":{"name":"Robot Tizen","username":"tizenrobot"},"message":"Patch Set 2:\n\n[BUILD CHECK RESULT] This change is built against OBS project Tizen:Mobile: \n\n repository     arch           result         \n\n emulator       i586           failed"},{"timestamp":1386851238,"reviewer":{"name":"Robot Tizen","username":"tizenrobot"},"message":"Patch Set 2:\n\n[BUILD CHECK RESULT] This change is built against OBS project Tizen:IVI: \n\n repository     arch           result         \n\n emulator       i586           succeeded"},{"timestamp":1386851299,"reviewer":{"name":"Robot Tizen","username":"tizenrobot"},"message":"Patch Set 2:\n\n[BUILD CHECK RESULT] This change is built against OBS project Tizen:Generic: \n\n repository     arch           result         \n\n ia32-wayland   i586           succeeded"},{"timestamp":1386917348,"reviewer":{"name":"Juan Zhao","username":"juanzhao"},"message":"Patch Set 2: Code-Review-1\n\n(1 comment)\n\nplease have a double check on your cmake command"},{"timestamp":1386928054,"reviewer":{"name":"wang fei","email":"feix.w.wang@intel.com","username":"wangfei"},"message":"Uploaded patch set 3."},{"timestamp":1386928088,"reviewer":{"name":"Robot Tizen","username":"tizenrobot"},"message":"Patch Set 3:\n\n[BUILD CHECK RESULT] This change is built against OBS project Tizen:IVI: \n\n repository     arch           result         \n\n emulator       i586           unresolvable   \n\n standard       i586           unresolvable"},{"timestamp":1386928338,"reviewer":{"name":"Robot Tizen","username":"tizenrobot"},"message":"Patch Set 3:\n\n[BUILD CHECK RESULT] This change is built against OBS project Tizen:Mobile: \n\n repository     arch           result         \n\n arm            x86_64         disabled       \n\n arm            armv7l         failed         \n\n arm            i586           disabled       \n\n emulator       i586           failed         \n\n atom           i586           failed"},{"timestamp":1386928422,"reviewer":{"name":"wang fei","email":"feix.w.wang@intel.com","username":"wangfei"},"message":"Uploaded patch set 4."},{"timestamp":1386928453,"reviewer":{"name":"Robot Tizen","username":"tizenrobot"},"message":"Patch Set 4:\n\n[BUILD CHECK RESULT] This change is built against OBS project Tizen:IVI: \n\n repository     arch           result         \n\n emulator       i586           unresolvable   \n\n standard       i586           unresolvable"},{"timestamp":1386928532,"reviewer":{"name":"Robot Tizen","username":"tizenrobot"},"message":"Patch Set 3:\n\n[BUILD CHECK RESULT] This change is built against OBS project Tizen:Generic: \n\n repository     arch           result         \n\n x86_64-wayland x86_64         succeeded      \n\n ia32-wayland   i586           succeeded      \n\n arm64-wayland  aarch64                       \n\n arm64-x11      aarch64                       \n\n armv7-x11      armv7l                        \n\n cross-accel    aarch64                       \n\n cross-accel    x86_64                        \n\n cross-accel    armv7l                        \n\n cross-accel    i586                          \n\n ia32-x11       i586           succeeded      \n\n x86_64-x11     x86_64         succeeded      \n\n armv7-wayland  armv7l"},{"timestamp":1386928742,"reviewer":{"name":"Robot Tizen","username":"tizenrobot"},"message":"Patch Set 4:\n\n[BUILD CHECK RESULT] This change is built against OBS project Tizen:Mobile: \n\n repository     arch           result         \n\n arm            x86_64         disabled       \n\n arm            armv7l         failed         \n\n arm            i586           disabled       \n\n emulator       i586           failed         \n\n atom           i586           failed"},{"timestamp":1386928892,"reviewer":{"name":"Robot Tizen","username":"tizenrobot"},"message":"Patch Set 4:\n\n[BUILD CHECK RESULT] This change is built against OBS project Tizen:Generic: \n\n repository     arch           result         \n\n x86_64-wayland x86_64         succeeded      \n\n ia32-wayland   i586           succeeded      \n\n arm64-wayland  aarch64                       \n\n arm64-x11      aarch64                       \n\n armv7-x11      armv7l                        \n\n cross-accel    aarch64                       \n\n cross-accel    x86_64                        \n\n cross-accel    armv7l                        \n\n cross-accel    i586                          \n\n ia32-x11       i586           succeeded      \n\n x86_64-x11     x86_64         succeeded      \n\n armv7-wayland  armv7l"},{"timestamp":1386929012,"reviewer":{"name":"Juan Zhao","username":"juanzhao"},"message":"Patch Set 4: Code-Review+1"},{"timestamp":1386934109,"reviewer":{"name":"Junfeng dong","email":"junfeng.dong@intel.com","username":"junfeng"},"message":"Patch Set 4: Code-Review-2\n\n(1 comment)"},{"timestamp":1387177341,"reviewer":{"name":"wang fei","email":"feix.w.wang@intel.com","username":"wangfei"},"message":"Uploaded patch set 5."},{"timestamp":1387177463,"reviewer":{"name":"Robot Tizen","username":"tizenrobot"},"message":"Patch Set 5:\n\n[BUILD CHECK RESULT] This change is built against OBS project devel:ivi: \n\n repository     arch           result         \n\n emulator       i586           succeeded      \n\n standard       i586           succeeded"},{"timestamp":1387177476,"reviewer":{"name":"Robot Tizen","username":"tizenrobot"},"message":"Patch Set 5:\n\n[BUILD CHECK RESULT] This change is built against OBS project Tizen:Mobile: \n\n repository     arch           result         \n\n arm            x86_64         disabled       \n\n arm            armv7l         failed         \n\n arm            i586           disabled       \n\n emulator       i586           failed         \n\n atom           i586           failed"},{"timestamp":1387177479,"reviewer":{"name":"Robot Tizen","username":"tizenrobot"},"message":"Patch Set 5:\n\n[BUILD CHECK RESULT] This change is built against OBS project Tizen:IVI: \n\n repository     arch           result         \n\n emulator       i586           succeeded      \n\n standard       i586           succeeded"},{"timestamp":1387177539,"reviewer":{"name":"wang fei","email":"feix.w.wang@intel.com","username":"wangfei"},"message":"Patch Set 5: Verified+1"},{"timestamp":1387177601,"reviewer":{"name":"Robot Tizen","username":"tizenrobot"},"message":"Patch Set 5:\n\n[BUILD CHECK RESULT] This change is built against OBS project Tizen:Generic: \n\n repository     arch           result         \n\n x86_64-wayland x86_64         succeeded      \n\n ia32-wayland   i586           succeeded      \n\n arm64-wayland  aarch64                       \n\n arm64-x11      aarch64                       \n\n armv7-x11      armv7l                        \n\n cross-accel    aarch64                       \n\n cross-accel    x86_64                        \n\n cross-accel    armv7l                        \n\n cross-accel    i586                          \n\n ia32-x11       i586           succeeded      \n\n x86_64-x11     x86_64         succeeded      \n\n armv7-wayland  armv7l"},{"timestamp":1387258883,"reviewer":{"name":"Junfeng dong","email":"junfeng.dong@intel.com","username":"junfeng"},"message":"Patch Set 5: Code-Review+1"},{"timestamp":1387258942,"reviewer":{"name":"Juan Zhao","username":"juanzhao"},"message":"Patch Set 5: Code-Review+1"},{"timestamp":1387851910,"reviewer":{"name":"wang fei","email":"feix.w.wang@intel.com","username":"wangfei"},"message":"Uploaded patch set 6."},{"timestamp":1387852604,"reviewer":{"name":"wang fei","email":"feix.w.wang@intel.com","username":"wangfei"},"message":"Patch Set 6: Verified+1"},{"timestamp":1387852724,"reviewer":{"name":"Juan Zhao","username":"juanzhao"},"message":"Patch Set 6: Code-Review+1"},{"timestamp":1389140562,"reviewer":{"name":"Brad Peters","email":"brad.t.peters@intel.com","username":"bradpeters"},"message":"Patch Set 6: Code-Review-1\n\nSeeing a couple of problems here.\n\n1. BuildRequires: (x11) needs to be added to the spec\n\n2. \"with wayland\" does not seem to set ENABLE_WAYLAND, since I am getting utilX errors when I try to build the wayland image"},{"timestamp":1389149165,"reviewer":{"name":"wang fei","email":"feix.w.wang@intel.com","username":"wangfei"},"message":"Patch Set 6: -Verified\n\n1.Currently we need to remove all X apis and replaced it by wayland, so I think we shouldn\u0027t add X11. Did you meet some errors that can be fixed by adding X11?\n2.could you use this cmd to have a try:sudo gbs build -A i586 --include-all --overwrite"},{"timestamp":1389167164,"reviewer":{"name":"wang fei","email":"feix.w.wang@intel.com","username":"wangfei"},"message":"Uploaded patch set 7."},{"timestamp":1389168750,"reviewer":{"name":"wang fei","email":"feix.w.wang@intel.com","username":"wangfei"},"message":"Uploaded patch set 8."},{"timestamp":1389169030,"reviewer":{"name":"wang fei","email":"feix.w.wang@intel.com","username":"wangfei"},"message":"Patch Set 8:\n\nsubmit patch set 10 to add the following post script in spec file in wayland situation:\nvconftool set -ft string file/private/org.tizen.menu-screen/engine \"wayland_egl\" -i -u 5000 â€“f"},{"timestamp":1389215963,"reviewer":{"name":"Brad Peters","email":"brad.t.peters@intel.com","username":"bradpeters"},"message":"Patch Set 8: Code-Review-1\n\nWhat I mean is, you need to add x11 in the with X section of the spec, as in:\n\n...\n%if %{with x}\nBuildRequires:  pkgconfig(utilX)\nBuildRequires:  pkgconfig(x11)\n%endif\n...\n\nAnd Yes, I am seeing build issues when trying to build with:\n\nwith x 0\nwith wayland 1\n\nThis should not be pulling in utilX at all, but is, as I see:\n\n[   15s] [ 95%] In file included from /home/abuild/rpmbuild/BUILD/org.tizen.menu-screen-1.1.1/src/layout.c:22:0:\n[   15s] /usr/include/utilX.h:44:19: fatal error: X11/X.h: No such file or directory\n[   15s]  #include \u003cX11/X.h\u003e\n[   15s]                    ^\n[   15s] compilation terminated."},{"timestamp":1389216031,"reviewer":{"name":"Brad Peters","email":"brad.t.peters@intel.com","username":"bradpeters"},"message":"Patch Set 8:\n\nUsed \"gbs build -A i586 --include-all --overwrite -P ia.30 -D build.conf\" as recommended and got the same result"},{"timestamp":1389217413,"reviewer":{"name":"Brad Peters","email":"brad.t.peters@intel.com","username":"bradpeters"},"message":"Patch Set 8:\n\nI mis-typed: that X error is being seen when I build with \"with x\" defined. \n\nYou just need to add a BuildRequires of x11 within the \"with  x\" section, and this patch will be fine"},{"timestamp":1389247162,"reviewer":{"name":"Wang Quanxian","email":"quanxian.wang@intel.com","username":"quanxianwang"},"message":"Patch Set 8:\n\n(3 comments)"},{"timestamp":1389249984,"reviewer":{"name":"Juan Zhao","username":"juanzhao"},"message":"Patch Set 8: Verified+1\n\nPeter, I can\u0027t reproduce it with tizen 3 mobile\u0027s latest repo. According to the dependency file generated by gbs, we find that, libX11-devel is added.\nadded libX11-devel because of app-core-common-devel:pkgconfig(x11)"},{"timestamp":1389311989,"reviewer":{"name":"Brad Peters","email":"brad.t.peters@intel.com","username":"bradpeters"},"message":"Patch Set 8: Verified+1 Code-Review+1\n\nI was finally able to get a successful build. Had to finesse my .gbs.conf.  \n\nThis looks fine now"},{"timestamp":1389356465,"reviewer":{"name":"Gustavo Lima Chaves","email":"gustavo.lima.chaves@intel.com","username":"limachaves"},"message":"Patch Set 8:\n\n(1 comment)"}]}
